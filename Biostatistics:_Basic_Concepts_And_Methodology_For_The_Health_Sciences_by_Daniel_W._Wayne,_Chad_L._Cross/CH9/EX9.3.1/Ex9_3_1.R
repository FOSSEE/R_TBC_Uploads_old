##Example 9.3.1 Pg.417
##Linear regression model

x <-  c(74.75,72.60,81.80,83.95,74.65,71.85,80.90,83.40,63.50,73.2,71.9,75,73.1,79,77,68.85,75.95,74.15,73.8,75.9,76.85,80.90,79.9,89.20,82,92,86.60,80.50,86,82.50,83.50,88.10,90.80,89.40,102,94.50,91,103,80,79,83.50,76,80.50,8.50,83,107.10,94.30,94.50,79.70,79.30,89.80,83.80,85.20,75.50,78.40,78.60,87.80,86.30,85.50,83.70,77.60,84.90,79.80,108.30,119.60,119.90,96.50,105.50,105,107,107,101,97,100,108,100,103,104,106,109,103.50,110,110,112,108.50,104,111,108.50,121,109,97.50,105.50,98,94.50,97,105,106,99,91,102.50,106,109.10,115,101,100.10,93.30,101.80,107.90,108.50)
y <- c(25.72,25.89,42.60,42.80,29.84,21.68,29.08,32.98,11.44,32.22,28.32,43.86,38.21,42.48,30.96,55.78,43.78,33.41,43.35,29.31,36.60,40.25,35.43,60.06,45.84,70.40,83.45,84.30,78.89,64.75,72.56,89.31,78.94,83.55,127,121,107,129,74.02,55.48,73.13,50.50,50.88,140,96.54,118,107,123,65.92,81.29,111,90.73,133,41.90,41.71,58.16,88.85,155,70.77,75.08,57.05,99.73,27.96,123,90.41,106,144,121,97.13,166,87.99,154,100,123,217,140,109,127,112,192,132,126,153,158,183,184,121,159,245,137,165,152,181,80.95,137,125,241,134,150,198,151,229,253,188,124,62.20,133,208,208)

plot(x,y,main="scatter plot of x and y",xlab="waist circumference",ylab="deep abdominal area")

reg = lm(y~x)  #Create a linear model
summary(reg)
resid(reg)   #List of residuals
plot(density(resid(reg))) #A density plot
qqnorm(resid(reg)) # A quantile normal plot - good for checking normality
qqline(resid(reg))

#Answers may differ due to approximations



