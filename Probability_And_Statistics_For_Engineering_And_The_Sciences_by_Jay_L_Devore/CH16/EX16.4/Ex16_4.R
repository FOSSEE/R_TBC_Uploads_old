#Ex16.4, Page 663
#Answers may vary slightly due to rounding off of values

#Package to be installed: qcc(Quality control charts)
library(qcc)

n<-4
k<-22
obs1<-c(29.7,32.2,35.9,28.8,30.9,30.6,32.3,32.0,24.2,33.7,35.3,28.1,28.7,29.0,33.5,26.9,30.4,29.0,33.8,29.7,27.9,30.0) 
obs2<-c(29.0,29.3,29.1,27.2,32.6,34.3,27.7,27.9,27.5,24.4,33.2,34.0,28.9,33.0,32.6,27.3,29.6,28.9,30.9,27.9,27.7,31.4)
obs3<-c(28.8,32.2,32.1,28.5,28.3,34.8,30.9,31.0,28.5,34.3,31.4,31.0,25.8,30.2,33.6,32.1,31.0,31.8,31.7,29.1,30.2,27.7) 
obs4<-c(30.2,32.9,31.3,35.7,28.3,26.3,27.8,30.8,31.1,31.0,28.0,30.8,29.7,30.1,29.2,28.5,33.8,26.7,28.2,30.1,32.9,28.1)
SD<-c(0.64,1.60,2.83,3.83,2.11,3.94,2.30,1.76,2.85,4.53,3.09,2.41,1.71,1.71,2.07,2.37,1.83,2.09,2.32,0.96,2.43,1.72) 
Range<-c(1.4,3.6,6.8,8.5,4.3,8.5,4.6,4.1,6.9,9.9,7.3,5.9,3.9,4.0,4.4,5.2,4.2,5.1,5.6,2.2,5.2,3.7)
data1<-data.frame(obs1,obs2,obs3,obs4)

#Sum of SD values
si<-sum(SD)
print(paste("Sum of SD values:",si))
sbar<-mean(SD)
print(paste("Mean of SD values:",sbar))

a4<-0.921
LCL<-0
UCL<-sbar+3*sbar*sqrt(1-a4^2)/a4
print(paste("LCL:",LCL))
print(paste("UCL:",UCL))

#To plot S chart
q4<-qcc(data1,type="S")
print(summary(q4))